{% extends "layout.html" %}
{% block content %}

<body class="fixed-sn white-skin">

    <!--Main Navigation-->
    <header>

        <!--Navbar-->
        <nav class="navbar fixed-top navbar-expand-lg scrolling-navbar double-nav">
            <!-- SideNav slide-out button -->
            <div class="float-left">
                <a href="#" data-activates="slide-out" class="button-collapse black-text"><i class="fa fa-bars"></i></a>
            </div>
            <!-- Breadcrumb-->
            <div class="breadcrumb-dn mr-auto">
                
            </div>

            <!--Navbar links-->
            <ul class="nav navbar-nav nav-flex-icons ml-auto">

                <!-- Dropdown -->
                <li class="nav-item dropdown notifications-nav">
                    <a class="nav-link dropdown-toggle waves-effect" id="navbarDropdownMenuLink" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                        {% if number_upcoming > 0 %}
                            <span class="badge red">{{number_upcoming}}</span> <i class="fa fa-bell"></i>
                        {% endif %}
                        <span class="d-none d-md-inline-block">Notifications</span>
                    </a>

                    <div class="dropdown-menu dropdown-info" aria-labelledby="navbarDropdownMenuLink">
                        {% if number_upcoming > 0 %}
                            {% for event in upcoming_events %}
                                <a class="dropdown-item" href="#">
                                    <i class="fa fa-times-rectangle mr-2" aria-hidden="true"></i>
                                    <span> {{ event['summary'] }} </span>
                                    <span class="float-right"><i class="fa fa-clock-o" aria-hidden="true"></i>
                                        {{ event['remain_days'] }} days
                                    </span>
                                </a>
                            {% endfor %}
                        {% else %}
                            <a class="dropdown-item" href="#">
                                <i class="fa fa-times-rectangle mr-2" aria-hidden="true"></i>
                                <span> No Events </span>
                                <span class="float-right">
                                    <i class="fa fa-clock-o" aria-hidden="true"></i>
                                    0 days
                                </span>
                            </a>
                        {% endif %}
                    </div>
                </li>
                <li class="nav-item">
                    <a class="nav-link waves-effect"><i class="fa fa-envelope"></i> <span class="clearfix d-none d-sm-inline-block">Inbox</span></a>
                </li>
                <li class="nav-item">
                    <a class="nav-link waves-effect" href="https://calendar.google.com/calendar/embed?src=bartlett%40pdx.edu&ctz=America%2FLos_Angeles">
                        <i class="fa fa-calendar"></i>
                        <span class="clearfix d-none d-sm-inline-block">Calendar</span>
                    </a>
                </li>
                <li class="nav-item dropdown">
                    <a class="nav-link dropdown-toggle waves-effect" href="#" id="userDropdown" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                        <i class="fa fa-user"></i> <span class="clearfix d-none d-sm-inline-block">{{ session['myusername']  }} </span></a>
                    </a>
                    <div class="dropdown-menu dropdown-menu-right" aria-labelledby="userDropdown">
                        <div class="navbar-login">
                            <div class="row">
                                <div class="col-lg-4">
                                    <img src="static/avatar/{{ current_user.avatar.file_name }}" class="img-fluid" alt="First sample image">
                                </div>
                                <div class="col-lg-8">
                                    <a class="dropdown-item" href="{{ url_for('logout') }}">Log Out</a>
                                    <a class="dropdown-item" href="{{ url_for('account') }}">Edit Profile</a>
                                </div>
                            </div>
                        </div>
                    </div>
                </li>

            </ul>
            <!--/Navbar links-->
        </nav>
        <!--/.Navbar-->

         <!-- Sidebar navigation -->
        <div id="slide-out" class="side-nav sn-bg-4 fixed">
            <ul class="custom-scrollbar">
            <!-- Logo -->
            <li class="logo-sn waves-effect">
                <div class="text-center">
                    <a href="#" class="pl-0"><img src="../static/img/mesa.png" class=""></a>
                </div>
            </li>
            <!--/. Logo -->
            <!-- Side navigation links -->
            <li>
                <ul class="collapsible collapsible-accordion">
                    <li><a href="{{ url_for('dashboard') }}" class="collapsible-header waves-effect arrow-r"><i class="fa fa-tachometer"></i> Dashboards</a>
                    </li>
                    <li><a href="{{ url_for('earn_stamps') }}" class="collapsible-header waves-effect arrow-r"><i class="fa fa-photo"></i> Get Stamp</a>
                    </li>
                    <li><a class="collapsible-header waves-effect arrow-r"><i class="fa fa-user"></i> View Progress<i class="fa fa-angle-down rotate-icon"></i></a>
                        <div class="collapsible-body">
                            <ul>
                                {% for r, i in result %}
                                    <li><a href="/badges/{{ i }}" class="waves-effect">{{ r }}</a></li>
                                {% endfor %}
                            </ul>
                        </div>
                    </li>
                </ul>
            </li>
            <!--/. Side navigation links -->
            </ul>
            <div class="sidenav-bg mask-strong"></div>
        </div>
        <!--/. Sidebar navigation -->
    </header>
    <!--Main Navigation-->


    <!--Main layout-->
    <main>

        <div class="container-fluid">

            <!-- First row -->

            <div class="row">

                <!-- Added by Millen: Catches flash messages -->
                {% with messages = get_flashed_messages(with_categories=true) %}
                          {% if messages %}
                            {% for category, message in messages %}
                              <div class="alert alert-{{ category }}">
                                {{ message }}
                              </div>
                            {% endfor %}
                          {% endif %}
                        {% endwith %}

                <!-- First column -->

                <div class="col-lg-8 col-md-12">
                    <div class="row">
                        <div class="col-lg-4 col-md-8">
                            <div class="card mb-4">
                                <div class="card-header white-text primary-color">
                                    First Event Countdown
                                </div>
                                <div class="card-body">
                                    <table>
                                        <tr><td>Time Until First Event<td></tr>
                                        <tr><td><span id="clock" data-date-string={{events[0][ 'date_string' ]}}></span></td></tr>
                                    </table>
                                </div>
                            </div>    
                        </div>
                        <div class="col-lg-4 col-md-8">
                            <div class="card mb-4">
                                <div class="card-header white-text primary-color">
                                    Last Event Countdown
                                </div>
                                <div class="card-body">
                                    <table>
                                        <tr><td>Time Until Last Event<td></tr>
                                        <tr><td><span id="clock2" data-date-string-second={{events[-1][ 'date_string' ]}}></span></td></tr>
                                    </table>
                                </div>
                            </div>    
                        </div>
                        <div class="col-lg-4 col-md-8">
                            <div class="card mb-4">
                                <div class="card-header white-text primary-color">
                                    MESA Day Countdown
                                </div>
                                <div class="card-body">
                                    <table>
                                        <tr><td>Time Until MESA Day<td></tr>
                                        <tr><td><span id="clock3" data-date-string-third={{mesa_days[0][ 'date_string' ]}}></span></td></tr>
                                    </table>
                                </div>
                            </div>    
                        </div>
                    </div>   

                    <!--Panel-->
                    <div class="card mb-4">
                        <div class="card-header white-text primary-color">
                            Badge Information
                        </div>
                        <div class="card-body">
                            <!-- Main student badge content goes here -->
                            <!-- <h5>Earned points</h5> -->
                            <!--Grid column-->
                            <div class="col-xl-12 col-md-6 mb-4">

                                <!--Card-->
                                <div class="card card-cascade cascading-admin-card">

                                    <!--Card Data-->
                                    <div class="admin-up">
                                        <img class="rounded-circle account-img" src="../static/badge_icons/College_Knowledge.png">
                                        <div class="data">
                                            {% for r, p in points %}
                                            {% if r == 'College Knowledge' %}
                                            <p>{{ r }}</p>
                                            <h4 class="font-weight-bold dark-grey-text">{{ p }}</h4>
                                        </div>
                                    </div>
                                    <!--/.Card Data-->

                                    <!--Card content-->
                                    <div class="card-body">
                                        <div class="progress">
                                            <div class="progress-bar bg-primary" role="progressbar" style="width: {{ p }}%" aria-valuenow="25" aria-valuemin="0" aria-valuemax="100"></div>
                                        </div>
                                        <!--Text-->
                                        <p class="card-text">Need {{ 100 - p }} Stamps</p>
                                        <button class="btn btn btn-flat grey lighten-3 btn-rounded waves-effect font-weight-bold dark-grey-text float-left">Add More Stamp</button>
                                    </div>
                                    <!--/.Card content-->
                                </div>
                                <!--/.Card-->

                            </div>
                            <!--Grid column-->
                            <br>
                            <!--Grid column-->
                            <div class="col-xl-12 col-md-6 mb-6">

                                <!--Card-->
                                <div class="card card-cascade cascading-admin-card">

                                    <!--Card Data-->
                                    <div class="admin-up">
                                        <img class="rounded-circle account-img" src="../static/badge_icons/Career_Pro.png">
                                        <div class="data">
                                            {% elif r == 'Career Pro' %}
                                            <p>{{ r }}</p>
                                            <h4 class="font-weight-bold dark-grey-text">{{ p }}</h4>
                                        </div>
                                    </div>
                                    <!--/.Card Data-->

                                    <!--Card content-->
                                    <div class="card-body">
                                        <div class="progress">
                                            <div class="progress-bar red accent-2" role="progressbar" style="width: {{ p }}%" aria-valuenow="25" aria-valuemin="0" aria-valuemax="100"></div>
                                        </div>
                                        <!--Text-->
                                        <p class="card-text">Need {{ 100 - p }} Stamps</p>
                                        <button class="btn btn btn-flat grey lighten-3 btn-rounded waves-effect font-weight-bold dark-grey-text float-left">Add More Stamp</button>
                                    </div>
                                    <!--/.Card content-->

                                </div>
                                <!--/.Card-->

                            </div>
                            <!--Grid column-->
                            <br>
                            <!--Grid column-->
                            <div class="col-xl-12 col-md-6 mb-4">

                                <!--Card-->
                                <div class="card card-cascade cascading-admin-card">

                                    <!--Card Data-->
                                    <div class="admin-up">
                                        <img class="rounded-circle account-img" src="../static/badge_icons/Professional_Development.png">
                                        <div class="data">
                                            {% elif r == 'Professional Development' %}
                                            <p>{{ r }}</p>
                                            <h4 class="font-weight-bold dark-grey-text">{{ p }}</h4>
                                        </div>
                                    </div>
                                    <!--/.Card Data-->

                                    <!--Card content-->
                                    <div class="card-body">
                                        <div class="progress">
                                            <div class="progress-bar red accent-2" role="progressbar" style="width: {{ p }}%" aria-valuenow="75" aria-valuemin="0" aria-valuemax="100"></div>
                                        </div>
                                        <!--Text-->
                                        <p class="card-text">Need {{ 100 - p }} Stamps</p>
                                        <button class="btn btn btn-flat grey lighten-3 btn-rounded waves-effect font-weight-bold dark-grey-text float-left">Add More Stamp</button>
                                    </div>
                                    <!--/.Card content-->

                                </div>
                                <!--/.Card-->

                            </div>
                            <!--Grid column-->
                            <br>
                            <!--Grid column-->
                            <div class="col-xl-12 col-md-6 mb-4">

                                <!--Card-->
                                <div class="card card-cascade cascading-admin-card">

                                    <!--Card Data-->
                                    <div class="admin-up">
                                        <img class="rounded-circle account-img" src="../static/badge_icons/MESA_Expert.png">
                                        <div class="data">
                                            {% else %}
                                            <p>{{r}}</p>
                                            <h4 class="font-weight-bold dark-grey-text">{{p}}</h4>
                                        </div>
                                    </div>
                                    <!--/.Card Data-->

                                    <!--Card content-->
                                    <div class="card-body">
                                        <div class="progress">
                                            <div class="progress-bar bg-primary" role="progressbar" style="width: {{p}}%" aria-valuenow="25" aria-valuemin="0" aria-valuemax="100"></div>
                                        </div>
                                        <!--Text-->
                                        <p class="card-text">Need {{ 100 - p }} Stamps</p>
                                        {% endif %}
                                        {% endfor %}
                                        <button class="btn btn btn-flat grey lighten-3 btn-rounded waves-effect font-weight-bold dark-grey-text float-left">Add More Stamp</button>
                                    </div>
                                    <!--/.Card content-->

                                </div>
                                <!--/.Card-->

                            </div>
                            <!--Grid column-->

                            <button class="btn btn btn-flat grey lighten-3 btn-rounded waves-effect font-weight-bold dark-grey-text float-right">View full report</button>

                        </div>
                    </div>
                    <!--/.Panel-->
                </div>

                <!-- Second column -->

                <div class="col-lg-4 col-md-12">

                    <!--Panel-->
                    <div class="card mb-4" id='calendar-div'>
                        <div class="card-header white-text primary-color">
                            Calendar
                        </div>
                        <div class="embed-responsive embed-responsive-16by9">
                            <iframe class="cal-iframe embed-responsive-item" id='cv_if5' src='http://cdn.instantcal.com/cvir.html?id=cv_nav5&file=https://calendar.google.com/calendar/ical/bartlett%40pdx.edu/public/basic.ics&theme=BL&ccolor=%23ffffc0&dims=1&gtype=cv_monthgrid&gcloseable=0&gnavigable=1&gperiod=month&itype=cv_simpleevent'
                                allowTransparency=true scrolling='no' frameborder=0 height=auto width=100%></iframe>
                        </div>
                    </div>
                    <!--/.Panel-->

                    <!--Panel-->
                    <div class="card mb-4">
                        <div class="card-header white-text primary-color">
                            Upcoming Events
                        </div>
                        <div class="card-body">
                            <table>
                                <tr><td>--Events--</td></tr>
                                {% for event in events[:10] %}
                                    <tr>
                                        <table>
                                            {% if event['remain_days'] < 15 %} 
                                                <tr>
                                                    <td>{{event['summary']}} in {{event['remain_days']}} days ({{event['calColor']}} : {{event['mesaColor']}})</td>
                                                </tr>
                                                <tr>
                                                    <td>on {{event['start_string']}}</td>
                                               </tr>
                                                <tr>
                                                    <td>or {{event['date_string']}}</td>
                                                </tr>
                                                <tr>
                                                    <td>at {{event['location']}}</td>
                                                </tr>
                                                <tr>
                                                    <td>badge: {{event['badgeColor']}}</td>
                                                </tr>
                                                <tr>
                                                    <td>--</td>
                                                </tr>
                                            {% endif %}
                                        </table>
                                    </tr>
                                {% endfor %}
                                <tr>--Events--</tr>
                                <div></div>
                                <tr>--Mesa Events--</tr>
                                {% for event in mesa_days %}
                                    <tr>
                                        <table>
                                            <tr>
                                                <td>{{event['summary']}}</td>
                                            </tr>
                                            <tr>
                                                <td>on {{event['start_string']}}</td>
                                            </tr>
                                            <tr>
                                                <td>or {{event['date_string']}}</td>
                                            </tr>
                                            <tr>
                                                <td>badge: {{event['badgeColor']}}</td>
                                            </tr>                                        
                                            <tr>
                                                <td>--</td>
                                            </tr>
                                        </table>
                                    </tr>
                                {% endfor %}
                                <tr>--Mesa Events--</tr>
                            </table>

                            <button class="btn btn btn-flat grey lighten-3 btn-rounded waves-effect font-weight-bold dark-grey-text float-right">View
                                full upcoming events</button>
                        </div>
                    </div>
                    <!--/.Panel-->
                </div>
                <!-- /.Second row -->
            </div>
    </main>
    <!--Main layout-->

    <!--Footer-->
    <footer class="page-footer pt-0 mt-5 rgba-stylish-light">

        <!--Copyright-->
        <div class="footer-copyright py-3 text-center">
            <div class="container-fluid">
                <a> MESA Office Contact Information </a>
            </div>
        </div>
        <!--/.Copyright-->

    </footer>
    <!--/.Footer-->

{% endblock content %}

{% block scripts %}
    {{ super() }}
{% endblock scripts %}

